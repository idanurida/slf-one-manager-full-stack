berikut adalah Entity Relationship Diagram (ERD) untuk user dengan role drafter dalam sistem SLF One Manager, lengkap dengan keterkaitannya terhadap entitas-entitas lainnya.

Asumsi:

Sistem ini menggunakan Supabase sebagai backend.
Autentikasi dan manajemen user menggunakan auth.users bawaan Supabase.
Tabel profiles digunakan untuk menyimpan metadata tambahan user (seperti full_name, role, specialization).
drafter adalah salah satu role yang bisa dimiliki oleh seorang user.
drafter bekerja di bawah koordinasi project_lead dan head_consultant.
drafter bertanggung jawab atas pembuatan dan pengelolaan dokumen teknis proyek.
ERD: User Drafter dalam SLF One Manager
Entitas Utama & Hubungannya:



1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
+------------------+       +------------------+       +------------------+
|   auth.users     |       |    profiles      |       |   projects       |
|------------------|       |------------------|       |------------------|
| id (PK) <--------+-------+ user_id (FK/UQ)  |<------+ project_lead_id  |
| email            |       | id (PK)          |       | id (PK)          |
| ...              |       | full_name        |       | name             |
+------------------+       | role             |       | description      |
                           | specialization   |       | address          |
                           | ...              |       | city             |
                           +------------------+       | client_id (FK)   |
                                                      | status           |
                                                      | ...              |
                                                      +------------------+
                                                             |
                                                             | 1
                                                             |
                                                   +------------------+
                                                   |  project_teams   |
                                                   |------------------|
                                                   | id (PK)          |
                                                   | project_id (FK)  |-------+
                                                   | user_id (FK)     |       |
                                                   | role             |       | *
                                                   | assigned_at      |       |
                                                   +------------------+       |
                                                             |                |
                                                             | *              |
                                                   +------------------+       |
                                                   |    documents     |<------+
                                                   |------------------|
                                                   | id (PK)          |
                                                   | project_id (FK)  |
                                                   | uploaded_by (FK) |-----> users.id (drafter)
                                                   | file_name        |
                                                   | document_type    |
                                                   | storage_path     |
                                                   | status           |
                                                   | uploaded_at      |
                                                   | ...              |
                                                   +------------------+
                                                             |
                                                             | 1
                                                             |
                                              +----------------------------+
                                              |   document_approvals       |
                                              |----------------------------|
                                              | id (PK)                    |
                                              | document_id (FK)           |
                                              | requested_by (FK)          |---> users.id (drafter/project_lead/head_consultant)
                                              | reviewed_by (FK)           |---> users.id (project_lead/head_consultant)
Penjelasan Keterkaitan:

auth.users ↔ profiles:
Relasi 1:1.
profiles.user_id adalah Foreign Key (FK) yang merujuk ke auth.users.id.
profiles menyimpan informasi tambahan seperti role dan specialization. Untuk drafter, role akan bernilai 'drafter'.
profiles (drafter) ↔ projects:
Relasi tidak langsung.
drafter tidak secara langsung terhubung ke projects. Hubungan ini dikelola oleh entitas project_teams.
profiles (drafter) ↔ project_teams:
Relasi 1:* (satu drafter bisa menjadi anggota banyak proyek).
project_teams.user_id adalah FK yang merujuk ke profiles.user_id.
project_teams.role menunjukkan peran user dalam proyek tertentu (misalnya 'drafter', 'inspector_sipil', dll.).
project_teams ↔ projects:
Relasi *:1 (banyak entri project_teams bisa merujuk ke satu project).
project_teams.project_id adalah FK yang merujuk ke projects.id.
profiles (drafter) ↔ documents:
Relasi 1:* (satu drafter bisa mengunggah banyak dokumen).
documents.uploaded_by adalah FK yang merujuk ke profiles.user_id. Ini menunjukkan siapa drafter yang mengunggah dokumen tersebut.
documents ↔ projects:
Relasi *:1 (banyak dokumen bisa terkait dengan satu proyek).
documents.project_id adalah FK yang merujuk ke projects.id.
profiles (drafter) ↔ document_approvals:
Relasi 1:* (satu drafter bisa meminta review untuk banyak dokumen).
document_approvals.requested_by adalah FK yang merujuk ke profiles.user_id.
profiles (selain drafter, misal project_lead/head_consultant) ↔ document_approvals:
Relasi 1:* (satu reviewer bisa me-review banyak dokumen).
document_approvals.reviewed_by adalah FK yang merujuk ke profiles.user_id.
documents ↔ document_approvals:
Relasi 1:* (satu dokumen bisa memiliki banyak siklus approval).
document_approvals.document_id adalah FK yang merujuk ke documents.id.
profiles (drafter) ↔ tasks:
Relasi 1:* (satu drafter bisa memiliki banyak task).
tasks.assignee_id adalah FK yang merujuk ke profiles.user_id.
tasks ↔ projects:
Relasi *:1 (banyak task bisa terkait dengan satu proyek).
tasks.project_id adalah FK yang merujuk ke projects.id.
profiles (inspector/drafter) ↔ checklist_responses:
Relasi 1:* (satu user bisa memberikan banyak respons checklist).
checklist_responses.responded_by adalah FK yang merujuk ke profiles.user_id. Baik inspector maupun drafter bisa memberikan respons, tergantung item checklist-nya.
checklist_responses ↔ inspection_photos:
Relasi 1:* (satu respons checklist bisa memiliki banyak foto).
inspection_photos.checklist_response_id adalah FK yang merujuk ke checklist_responses.id. Catatan: Jika checklist_responses tidak memiliki id auto-increment, maka FK ini bisa merujuk ke kombinasi unik seperti (item_id, responded_by).
profiles (inspector) ↔ inspection_photos:
Relasi 1:* (satu inspector bisa mengambil banyak foto).
inspection_photos.inspector_id adalah FK yang merujuk ke profiles.user_id.
profiles (user) ↔ notifications:
Relasi 1:* (satu user bisa menerima banyak notifikasi).
notifications.recipient_id adalah FK yang merujuk ke profiles.user_id.
profiles (user) ↔ notifications (sebagai aktor):
Relasi 1:* (satu user bisa memicu banyak notifikasi).
notifications.actor_id adalah FK yang merujuk ke profiles.user_id.
Ringkasan Peran Drafter:

Anggota Proyek: Melalui project_teams, drafter menjadi bagian dari tim proyek.
Pembuat Dokumen: Mengunggah dan mengelola dokumen teknis proyek melalui tabel documents.
Pemohon Review: Bisa meminta review dokumen melalui tabel document_approvals.
Pemberi Respons Checklist: Bisa mengisi item-item checklist (tertentu) melalui tabel checklist_responses.
Penerima Tugas: Menerima dan mengelola task yang diberikan melalui tabel tasks.
Penerima Notifikasi: Menerima notifikasi sistem melalui tabel notifications.
ERD ini memberikan gambaran menyeluruh tentang bagaimana entitas drafter berinteraksi dan berelasi dengan berbagai komponen data dalam sistem SLF One Manager.